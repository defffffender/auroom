{
  "permissions": {
    "allow": [
      "Bash(python manage.py makemigrations:*)",
      "Bash(venv\\Scripts\\python.exe:*)",
      "Bash(./venv/Scripts/python.exe manage.py makemigrations:*)",
      "Bash(./venv/Scripts/python.exe manage.py migrate:*)",
      "Bash(./venv/Scripts/python.exe:*)",
      "Bash(find:*)",
      "Bash(python manage.py shell:*)",
      "Bash(venvScriptspython.exe manage.py makemigrations)",
      "Bash(dir /s /b *.py)",
      "Bash(NUL)",
      "Bash(del /f catalogcontext_processors.py)",
      "Bash(git rm:*)",
      "Bash(python -m pip freeze:*)",
      "Bash(requirements.txt)",
      "Bash(echo:*)",
      "Bash(CHANGELOG_AUDIT_FIXES.md)",
      "Bash(git add:*)",
      "Bash(curl:*)",
      "Bash(git commit:*)",
      "Bash(.\\venv\\Scripts\\python.exe manage.py:*)",
      "Bash(git push:*)",
      "Bash(ssh -o StrictHostKeyChecking=no root@185.217.131.179 \"ls -la /root\")",
      "Bash(ssh root@185.217.131.179 \"systemctl list-units --type=service --state=running | grep -E ''django|gunicorn|telegram|bot'' || echo ''No Django/Telegram services found''\")",
      "Bash(ssh root@185.217.131.179 \"systemctl stop gunicorn telegram-bot && systemctl disable gunicorn telegram-bot && echo ''Old services stopped and disabled''\")",
      "Bash(ssh root@185.217.131.179 \"find /root -maxdepth 2 -type d -name ''*bot*'' -o -name ''*django*'' -o -name ''bfbot'' 2>/dev/null || echo ''No old projects found''\")",
      "Bash(ssh root@185.217.131.179 \"ls -la /var/www/ 2>/dev/null || echo ''No /var/www directory''\")",
      "Bash(ssh root@185.217.131.179 \"rm -rf /var/www/bfbot && rm -f /etc/systemd/system/gunicorn.service /etc/systemd/system/telegram-bot.service && systemctl daemon-reload && echo ''Old projects and configs removed''\")",
      "Bash(ssh root@185.217.131.179 \"cd /root && git clone -b dev https://github.com/defffffender/auroom.git && echo ''Project cloned successfully''\")",
      "Bash(ssh root@185.217.131.179 \"cd /root/auroom && python3 -c ''from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())''\")",
      "Bash(ssh root@185.217.131.179 \"cat /root/auroom/.env\")",
      "Bash(ssh root@185.217.131.179 \"cd /root/auroom && bash deploy.sh 2>&1\")",
      "Bash(ssh root@185.217.131.179 \"ls -la /root/auroom/.env 2>&1\")",
      "Bash(ssh root@185.217.131.179 'cat /root/auroom/.env | grep \"\"^DB_PASSWORD\"\" | cut -d\"\"=\"\" -f2')",
      "Bash(ssh root@185.217.131.179 \"sudo -u postgres psql -c \"\"ALTER USER auroom_user WITH PASSWORD ''AuroomDB_BIMYux0BhQULHNXFVaQ0_2024'';\"\" && echo ''PostgreSQL password updated successfully''\")",
      "Bash(ssh root@185.217.131.179 \"cd /root/auroom && source venv/bin/activate && python manage.py migrate 2>&1\")",
      "Bash(ssh root@185.217.131.179 \"cd /root/auroom && source venv/bin/activate && python manage.py collectstatic --noinput 2>&1 | tail -20\")",
      "Bash(ssh root@185.217.131.179 \"cp /root/auroom/nginx_auroom.conf /etc/nginx/sites-available/auroom && ln -sf /etc/nginx/sites-available/auroom /etc/nginx/sites-enabled/auroom && rm -f /etc/nginx/sites-enabled/default && nginx -t 2>&1\")",
      "Bash(ssh root@185.217.131.179 \"grep -q ''server_names_hash_bucket_size'' /etc/nginx/nginx.conf || sed -i ''/http {/a \\    server_names_hash_bucket_size 64;'' /etc/nginx/nginx.conf && nginx -t 2>&1\")",
      "Bash(ssh root@185.217.131.179 \"ls -la /etc/nginx/sites-enabled/\")",
      "Bash(ssh root@185.217.131.179 \"rm -f /etc/nginx/sites-enabled/bfbot /etc/nginx/sites-available/bfbot && nginx -t 2>&1\")",
      "Bash(ssh root@185.217.131.179 \"cp /root/auroom/auroom.service /etc/systemd/system/auroom.service && systemctl daemon-reload && systemctl enable auroom && systemctl start auroom && systemctl restart nginx && echo ''Services started successfully''\")",
      "Bash(ssh root@185.217.131.179:*)",
      "Bash(ssh root@185.217.131.179 \"cd /root/auroom && source venv/bin/activate && python manage.py load_jewelry_data 2>&1 | head -50\")",
      "Bash(ssh root@185.217.131.179 \"cd /root/auroom && source venv/bin/activate && python manage.py shell -c \"\"from catalog.models import Factory; print(f''–§–∞–±—Ä–∏–∫ –≤ –ë–î: {Factory.objects.count()}'')\"\"\")",
      "Bash(ssh root@185.217.131.179 \"cd /root/auroom && git pull origin dev 2>&1\")",
      "Bash(ssh root@185.217.131.179 \"ab -n 500 -c 10 ''http://185.217.131.179/?category=kolca'' 2>&1\")",
      "Bash(ssh root@185.217.131.179 \"ab -n 500 -c 10 http://185.217.131.179/product/TEST-000001/ 2>&1\")",
      "Bash(ssh root@185.217.131.179 \"cd /root/auroom && source venv/bin/activate && python manage.py shell -c \"\"\nfrom django.db import connection\nfrom django.test.utils import CaptureQueriesContext\nfrom catalog.models import Product\nimport time\n\n# –¢–µ—Å—Ç 1: –ó–∞–ø—Ä–æ—Å –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π\nstart = time.time()\nwith CaptureQueriesContext(connection) as ctx:\n    products = list(Product.objects.filter(is_active=True).select_related(''factory'', ''category'', ''material'', ''purity'', ''metal_color'', ''style'')[:12])\nend = time.time()\nprint(f''–ó–∞–ø—Ä–æ—Å –∫–∞—Ç–∞–ª–æ–≥–∞ (12 —Ç–æ–≤–∞—Ä–æ–≤): {len(ctx.captured_queries)} SQL –∑–∞–ø—Ä–æ—Å–æ–≤, {(end-start)*1000:.2f}ms'')\n\n# –¢–µ—Å—Ç 2: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\nstart = time.time()\nwith CaptureQueriesContext(connection) as ctx:\n    products = list(Product.objects.filter(is_active=True, category__slug=''kolca'').select_related(''factory'', ''category'', ''material'')[:12])\nend = time.time()\nprint(f''–§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: {len(ctx.captured_queries)} SQL –∑–∞–ø—Ä–æ—Å–æ–≤, {(end-start)*1000:.2f}ms'')\n\n# –¢–µ—Å—Ç 3: –ü–æ–¥—Å—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤\nstart = time.time()\ncount = Product.objects.filter(is_active=True).count()\nend = time.time()\nprint(f''–ü–æ–¥—Å—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤: {count} —Ç–æ–≤–∞—Ä–æ–≤, {(end-start)*1000:.2f}ms'')\n\"\"\")",
      "Bash(git commit -m \"$(cat <<''EOF''\nfeat: Add native lazy loading for product images\n\n–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞—Ç–∏–≤–Ω–∞—è –ª–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (lazy loading) –¥–ª—è –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç–æ–≤–∞—Ä–æ–≤.\n\n–ò–∑–º–µ–Ω–µ–Ω–∏—è:\n- home.html: –¥–æ–±–∞–≤–ª–µ–Ω loading=\"lazy\" –¥–ª—è –º–∏–Ω–∏–∞—Ç—é—Ä —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ\n- product_detail.html: –¥–æ–±–∞–≤–ª–µ–Ω loading=\"lazy\" –¥–ª—è –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–æ—Å–Ω–æ–≤–Ω–æ–µ, –≥–∞–ª–µ—Ä–µ—è, –ø–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã, –ª–æ–≥–æ—Ç–∏–ø—ã –∑–∞–≤–æ–¥–æ–≤)\n- product_fullscreen.html: –¥–æ–±–∞–≤–ª–µ–Ω loading=\"eager\" –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞), loading=\"lazy\" –¥–ª—è –º–∏–Ω–∏–∞—Ç—é—Ä\n\n–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:\n- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏\n- –≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π\n- –ë—ã—Å—Ç—Ä–µ–µ –≤—Ä–µ–º—è –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (FCP, LCP)\n- –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö\n\nü§ñ Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(ssh root@185.217.131.179 \"systemctl restart auroom && systemctl status auroom --no-pager\")",
      "Bash(ssh:*)",
      "Bash(ls:*)",
      "Bash(scp images/*.png root@185.217.131.179:/root/images/)",
      "Bash(ssh root@185.217.131.179 \"ls -lh /root/images/*.png | wc -l && du -sh /root/images/\")",
      "Bash(ssh root@185.217.131.179 \"cd /root/auroom && source venv/bin/activate && python manage.py generate_test_products --count 100000 --delete-old 2>&1\")",
      "Bash(ssh root@185.217.131.179 \"cd /root/auroom && source venv/bin/activate && python manage.py shell -c \"\"from catalog.models import Product, ProductImage; print(f''–¢–æ–≤–∞—Ä–æ–≤: {Product.objects.count()}''); print(f''–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: {ProductImage.objects.count()}'')\"\"\")",
      "Bash(ssh root@185.217.131.179 \"cd /root/auroom && tail -100 /var/log/auroom/gunicorn-error.log | grep -i error || echo ''No errors in gunicorn log''\")",
      "Bash(pip install:*)",
      "Bash(venv\\\\Scripts\\\\pip.exe install:*)",
      "Bash(.\\\\venv\\\\Scripts\\\\pip.exe install:*)",
      "Bash(python -m pip install:*)",
      "Bash(python manage.py migrate:*)",
      "Bash(python manage.py:*)"
    ],
    "deny": [],
    "ask": []
  }
}

{% extends 'catalog/base.html' %}
{% load static %}

{% block title %}–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç - {{ factory.name }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block header_title %}üè≠ {{ factory.name }}{% endblock %}

{% block header_nav %}
<a href="{% url 'catalog:home' %}">üì¶ –ö–∞—Ç–∞–ª–æ–≥</a>
<a href="{% url 'catalog:factory_profile_edit' %}">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
<a href="{% url 'catalog:logout' %}">üö™ –í—ã—Ö–æ–¥</a>
{% endblock %}

{% block content %}
<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div class="stats">
    <div class="stat-card">
        <h3>–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</h3>
        <div class="value">{{ stats.total_products }}</div>
    </div>
    <div class="stat-card">
        <h3>–ê–∫—Ç–∏–≤–Ω—ã—Ö</h3>
        <div class="value">{{ stats.active_products }}</div>
    </div>
    <div class="stat-card">
        <h3>–í –Ω–∞–ª–∏—á–∏–∏</h3>
        <div class="value">{{ stats.in_stock }}</div>
    </div>
    <div class="stat-card">
        <h3>–í—Å–µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</h3>
        <div class="value">{{ stats.total_views }}</div>
    </div>
</div>

<!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ -->
<div class="section">
    <div class="section-header">
        <h2>–ú–æ–∏ —Ç–æ–≤–∞—Ä—ã</h2>
        <a href="{% url 'catalog:product_add' %}" class="btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</a>
    </div>

    {% if products %}
    <table class="products-table">
        <thead>
            <tr>
                <th>–§–æ—Ç–æ</th>
                <th>–ê—Ä—Ç–∏–∫—É–ª</th>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                <th>–¶–µ–Ω–∞</th>
                <th>–û—Å—Ç–∞—Ç–æ–∫</th>
                <th>–ü—Ä–æ—Å–º–æ—Ç—Ä—ã</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>
                    {% if product.images.all.0 %}
                    <img src="{{ product.images.all.0.image.url }}" class="product-image-small" alt="{{ product.name }}">
                    {% else %}
                    <div class="product-image-small"></div>
                    {% endif %}
                </td>
                <td><strong>{{ product.article }}</strong></td>
                <td>{{ product.name }}</td>
                <td>{{ product.category.name }}</td>
                <td><strong>{{ product.price }} $</strong></td>
                <td>{{ product.stock_quantity }} —à—Ç</td>
                <td>{{ product.views_count }}</td>
                <td>
                    {% if product.is_active %}
                    <span class="status-badge status-active">–ê–∫—Ç–∏–≤–µ–Ω</span>
                    {% else %}
                    <span class="status-badge status-inactive">–ù–µ–∞–∫—Ç–∏–≤–µ–Ω</span>
                    {% endif %}
                </td>
                <td>
                    <div class="actions">
                        <a href="{% url 'catalog:product_edit' product.article %}" class="btn btn-small btn-secondary">‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å</a>
                        <a href="{% url 'catalog:product_delete' product.article %}" class="btn btn-small btn-danger">üóëÔ∏è</a>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <h3>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</h3>
        <p>–ù–∞—á–Ω–∏—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ –∫–∞—Ç–∞–ª–æ–≥, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏—Ö –∫–ª–∏–µ–Ω—Ç–∞–º</p>
        <br>
        <a href="{% url 'catalog:product_add' %}" class="btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π —Ç–æ–≤–∞—Ä</a>
    </div>
    {% endif %}
</div>
{% endblock %}